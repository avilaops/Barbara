@echo off
chcp 65001 >nul
color 0A
cls

echo.
echo โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ
echo.
echo     โโโโโโโ  โโโโโโ โโโโโโโ โโโโโโโ  โโโโโโ โโโโโโโ  โโโโโโ     โโโโโโ โโโโโโโ โโโ
echo     โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ   โโโโโโโโโโโโโโโโโโโ
echo     โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ   โโโโโโโโโโโโโโโโโโโ
echo     โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ   โโโโโโโโโโโโโโโ โโโ
echo     โโโโโโโโโโโ  โโโโโโ  โโโโโโโโโโโโโโ  โโโโโโ  โโโโโโ  โโโ   โโโ  โโโโโโ     โโโ
echo     โโโโโโโ โโโ  โโโโโโ  โโโโโโโโโโ โโโ  โโโโโโ  โโโโโโ  โโโ   โโโ  โโโโโโ     โโโ
echo.
echo                            โก API .NET 9 - Framework Avila โก
echo.
echo โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ
echo.
echo  ๐ฆ Sistema de Gestรฃo Empresarial
echo  ๐ง Tecnologia: ASP.NET Core 9.0 + MongoDB
echo  ๐ Porta: http://localhost:5000
echo  ๐ Swagger: http://localhost:5000/swagger
echo.
echo โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ
echo.

echo [1/4] ๐ Verificando MongoDB...
timeout /t 1 /nobreak >nul

tasklist /FI "IMAGENAME eq mongod.exe" 2>NUL | find /I /N "mongod.exe">NUL
if "%ERRORLEVEL%"=="0" (
    echo       โ MongoDB estรก rodando!
) else (
    echo       โ๏ธ  MongoDB NรO estรก rodando!
    echo       ๐ก Iniciando MongoDB...
    start "" "C:\Program Files\MongoDB\Server\8.0\bin\mongod.exe" --dbpath "C:\data\db"
    timeout /t 3 /nobreak >nul
)

echo.
echo [2/4] ๐ Navegando para diretรณrio...
cd /d "%~dp0Src\Barbara.API"
echo       โ Diretรณrio: %CD%

echo.
echo [3/4] ๐ง Verificando .env...
if exist ".env" (
    echo       โ Arquivo .env encontrado!
    type .env
) else (
    echo       โ Arquivo .env NรO encontrado!
    echo       Criando .env padrรฃo...
    (
        echo MONGODB_CONNECTION_STRING=mongodb://localhost:27017/barbara
        echo ASPNETCORE_ENVIRONMENT=Development
        echo ASPNETCORE_URLS=http://localhost:5000
    ) > .env
    echo       โ .env criado!
)

echo.
echo [4/4] ๐ Iniciando Barbara API...
echo.
echo โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ
echo.
echo     ๐ฅ BARBARA ESTร SUBINDO!
echo.
echo     ๐ URL: http://localhost:5000
echo     ๐ Docs: http://localhost:5000/swagger
echo.
echo     ๐ก Pressione Ctrl+C para parar o servidor
echo.
echo โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ
echo.

timeout /t 2 /nobreak >nul

dotnet run

echo.
echo.
echo โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ
echo.
echo     ๐ Barbara API foi encerrado!
echo.
echo โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ
echo.
pause
